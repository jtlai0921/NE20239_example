<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#31532;&nbsp;14&nbsp;&#31456;&nbsp;&#24615;&#33021;&#25552;&#21319;&#65288;Improving performance&#65289;</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;"><link rel="up" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;"><link rel="previous" href="querysql.html" title="&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#21407;&#29983;SQL&#26597;&#35810;"><link rel="next" href="toolsetguide.html" title="&#31532;&nbsp;15&nbsp;&#31456;&nbsp;&#24037;&#20855;&#31665;&#25351;&#21335;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#31532;&nbsp;14&nbsp;&#31456;&nbsp;&#24615;&#33021;&#25552;&#21319;&#65288;Improving performance&#65289;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="querysql.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="toolsetguide.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="performance"></a>&#31532;&nbsp;14&nbsp;&#31456;&nbsp;&#24615;&#33021;&#25552;&#21319;&#65288;Improving performance&#65289;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-collections"></a>14.1.&nbsp;&#29702;&#35299;&#38598;&#21512;&#30340;&#24615;&#33021;</h2></div></div><div></div></div><p>
            &#25105;&#20204;&#24050;&#32463;&#33457;&#20102;&#24456;&#38271;&#26102;&#38388;&#22312;&#35752;&#35770;&#38598;&#21512;(collections)&#20102;&#12290;&#22312;&#26412;&#31456;&#65292;&#25105;&#20204;&#20250;&#29305;&#21035;&#20851;&#27880;&#19968;&#20123;&#20851;&#20110;&#38598;&#21512;&#22312;&#36816;&#34892;&#26102;&#22914;&#20309;&#36816;&#20316;&#30340;&#38382;&#39064;&#12290;
        </p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-taxonomy"></a>14.1.1.&nbsp;&#20998;&#31867;</h3></div></div><div></div></div><p>Hibernate&#23450;&#20041;&#20102;&#19977;&#31181;&#22522;&#26412;&#31867;&#22411;&#30340;&#38598;&#21512;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>&#20540;&#38598;&#21512;</p></li><li><p>&#19968;&#23545;&#22810;&#20851;&#32852;</p></li><li><p>&#22810;&#23545;&#22810;&#20851;&#32852;</p></li></ul></div><p>
                &#36825;&#20010;&#20998;&#31867;&#26159;&#25353;&#29031;&#19981;&#21516;&#30340;&#34920;&#21644;&#22806;&#38190;&#20851;&#31995;&#31867;&#22411;&#26469;&#21306;&#20998;&#30340;&#65292;&#20294;&#26159;&#27809;&#26377;&#21578;&#35785;&#25105;&#20204;&#20851;&#20110;&#20851;&#31995;&#27169;&#22411;&#30340;&#19968;&#20999;&#12290;&#35201;&#23436;&#20840;&#29702;&#35299;&#20182;&#20204;&#30340;&#20851;&#31995;&#32467;&#26500;&#21644;&#24615;&#33021;&#29305;&#28857;&#65292;&#25105;&#20204;&#24517;&#39035;&#24605;&#32771;&#29992;&#20110;&#26356;&#26032;&#25110;&#21024;&#38500;&#38598;&#21512;&#34892;&#30340;&#20027;&#38190;&#30340;&#32467;&#26500;&#12290;&#36825;&#24471;&#21040;&#20102;&#22914;&#19979;&#30340;&#20998;&#31867;&#65306;
            </p><div class="itemizedlist"><ul type="disc"><li><p>&#26377;&#24207;&#38598;&#21512;&#31867;</p></li><li><p>&#38598;&#21512;&#65288;sets&#65289;</p></li><li><p>&#21253;&#65288;bags&#65289;</p></li></ul></div><p>
                &#26377;&#24207;&#38598;&#21512;&#31867;&#65288;maps, lists, arrays)&#26377;&#19968;&#20010;&#21253;&#21547;&#26377;<tt class="literal">&lt;key&gt;</tt>&#21644;<tt class="literal">&lt;index&gt;</tt>&#23383;&#27573;&#30340;&#20027;&#38190;&#12290;&#36825;&#31181;&#24773;&#20917;&#19979;&#38598;&#21512;&#31867;&#26356;&#26032;&#26159;&#29305;&#21035;&#39640;&#25928;&#30340;&#8212;&#8212;&#20027;&#38190;&#20250;&#26377;&#25928;&#32034;&#24341;&#65292;&#24403;Hibernate&#35797;&#22270;&#26356;&#26032;&#25110;&#21024;&#38500;&#19968;&#34892;&#26102;&#65292;&#21487;&#20197;&#36805;&#36895;&#25214;&#21040;&#36825;&#19968;&#34892;&#12290;
            </p><p>
                &#38598;&#21512;(sets)&#30340;&#20027;&#38190;&#21253;&#21547;&#26377; <tt class="literal">&lt;key&gt;</tt> &#21644;&#20803;&#32032;&#23383;&#27573;&#12290;&#23545;&#20110;&#26377;&#20123;&#20803;&#32032;&#31867;&#22411;&#26469;&#35828;&#65292;&#36825;&#20250;&#21464;&#24471;&#20302;&#25928;&#65292;&#29305;&#21035;&#26159;&#32452;&#21512;&#20803;&#32032;&#25110;&#32773;&#22823;&#25991;&#26412;&#12289;&#22823;&#20108;&#36827;&#21046;&#23383;&#27573;&#65307;&#25968;&#25454;&#24211;&#21487;&#33021;&#26080;&#27861;&#26377;&#25928;&#23545;&#22797;&#26434;&#30340;&#20027;&#38190;&#36827;&#34892;&#32034;&#24341;&#12290;&#21478;&#19968;&#26041;&#38754;&#65292;&#23545;&#20110;&#19968;&#23545;&#22810;&#25110;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#29305;&#21035;&#26159;&#21512;&#25104;&#30340;&#26631;&#35782;&#31526;&#26469;&#35828;&#65292;&#23427;&#20250;&#36798;&#21040;&#21516;&#26679;&#30340;&#39640;&#25928;&#12290;&#65288;&#38468;&#27880;&#65306;&#22914;&#26524;&#20320;&#24076;&#26395;<tt class="literal">SchemaExport</tt>&#20026;&#20320;&#30340;<tt class="literal">&lt;set&gt;</tt>&#21019;&#24314;&#20027;&#38190;&#65292;&#20320;&#24517;&#39035;&#25226;&#25152;&#26377;&#30340;&#23383;&#27573;&#37117;&#22768;&#26126;&#20026;<tt class="literal">not-null="true"</tt>&#12290;&#65289;
                
            </p><p>
                Bag&#26159;&#26368;&#24046;&#30340;&#12290;&#22240;&#20026;bag&#20801;&#35768;&#37325;&#22797;&#30340;&#20803;&#32032;&#20540;&#65292;&#20063;&#27809;&#26377;&#32034;&#24341;&#23383;&#27573;&#65292;&#19981;&#21487;&#33021;&#23450;&#20041;&#20027;&#38190;&#12290;Hibernate&#27809;&#26377;&#21150;&#27861;&#26469;&#21028;&#26029;&#20986;&#37325;&#22797;&#30340;&#34892;&#12290;&#27599;&#24403;&#36825;&#31181;&#38598;&#21512;&#34987;&#26356;&#25913;&#65292;Hibernate&#20250;&#23436;&#25972;&#22320;&#31227;&#38500;&#65288;&#36890;&#36807;&#19968;&#20010;<tt class="literal">DELETE</tt>&#65289;,&#20877;&#37325;&#24314;&#25972;&#20010;&#38598;&#21512;&#12290;&#36825;&#20250;&#38750;&#24120;&#20302;&#25928;&#12290;
            </p><p>
                &#35831;&#27880;&#24847;&#23545;&#19968;&#23545;&#22810;&#20851;&#32852;&#26469;&#35828;&#65292;&#8220;&#20027;&#38190;&#8221;&#21487;&#33021;&#26159;&#25968;&#25454;&#24211;&#34920;&#30340;&#29289;&#29702;&#20027;&#38190;&#8212;&#8212;&#20294;&#23601;&#31639;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#19978;&#38754;&#30340;&#20998;&#31867;&#20173;&#28982;&#26159;&#26377;&#29992;&#30340;&#12290;&#65288;&#23427;&#20250;&#21453;&#26144;Hibernate&#26159;&#22914;&#20309;&#22312;&#38598;&#21512;&#30340;&#21508;&#20010;&#34892;&#20013;&#8220;&#23450;&#20301;&#8221;&#30340;&#12290;&#65289;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-mostefficientupdate"></a>14.1.2.&nbsp;Lists, maps &#21644;sets&#29992;&#20110;&#26356;&#26032;&#25928;&#29575;&#26368;&#39640;</h3></div></div><div></div></div><p>
            &#26681;&#25454;&#25105;&#20204;&#19978;&#38754;&#30340;&#35752;&#35770;&#65292;&#26174;&#28982;&#26377;&#24207;&#31867;&#22411;&#21644;&#22823;&#22810;&#25968;set&#21487;&#20197;&#22312;&#22686;&#21152;/&#21024;&#38500;/&#20462;&#25913;&#20803;&#32032;&#30340;&#26102;&#20505;&#24471;&#21040;&#26368;&#22909;&#30340;&#24615;&#33021;&#12290;
        </p><p>
            &#20294;&#26159;&#65292;&#22312;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#25110;&#32773;&#23545;&#20540;&#20803;&#32032;&#32780;&#35328;&#65292;&#26377;&#24207;&#38598;&#21512;&#31867;&#27604;&#38598;&#21512;(set)&#26377;&#19968;&#20010;&#22909;&#22788;&#12290;&#22240;&#20026;<tt class="literal">Set</tt>&#30340;&#32467;&#26500;&#65292;&#22914;&#26524;&#8220;&#25913;&#21464;&#8221;&#20102;&#19968;&#20010;&#20803;&#32032;,Hibernate&#24182;&#19981;&#20250;<tt class="literal">UPDATE</tt>&#36825;&#19968;&#34892;&#12290;&#23545;<tt class="literal">Set</tt>&#26469;&#35828;&#65292;&#21482;&#26377;<tt class="literal">INSERT</tt>&#21644;<tt class="literal">DELETE</tt>&#25165;&#26377;&#25928;&#12290;&#27880;&#24847;&#36825;&#19968;&#27573;&#25551;&#36848;&#23545;&#19968;&#23545;&#22810;&#20851;&#32852;&#24182;&#19981;&#36866;&#29992;&#12290;
        </p><p>
            &#27880;&#24847;&#21040;&#25968;&#32452;&#26080;&#27861;&#24310;&#36831;&#36716;&#36733;&#65292;&#25105;&#20204;&#21487;&#20197;&#24471;&#20986;&#32467;&#35770;&#65292;list, map&#21644;set&#26159;&#26368;&#39640;&#25928;&#30340;&#38598;&#21512;&#31867;&#22411;&#12290;&#65288;&#24403;&#28982;&#65292;&#25105;&#20204;&#35686;&#21578;&#36807;&#20102;&#65292;&#30001;&#20110;&#38598;&#21512;&#20013;&#30340;&#20540;&#30340;&#20851;&#31995;&#65292;set&#21487;&#33021;&#24615;&#33021;&#19979;&#38477;&#12290;&#65289;
        </p><p>
            Set&#21487;&#20197;&#34987;&#30475;&#20316;&#26159;Hibernate&#31243;&#24207;&#20013;&#26368;&#26222;&#36941;&#30340;&#38598;&#21512;&#31867;&#22411;&#12290;
        </p><p>
            <span class="emphasis"><em>&#36825;&#20010;&#29256;&#26412;&#30340;Hibernate&#26377;&#19968;&#20010;&#27809;&#26377;&#20889;&#22312;&#25991;&#26723;&#20013;&#30340;&#21151;&#33021;&#12290;<tt class="literal">&lt;idbag&gt;</tt>&#21487;&#20197;&#23545;&#20540;&#38598;&#21512;&#21644;&#22810;&#23545;&#22810;&#20851;&#32852;&#23454;&#29616;bag&#35821;&#20041;&#65292;&#24182;&#19988;&#24615;&#33021;&#27604;&#19978;&#38754;&#20219;&#20309;&#31867;&#22411;&#37117;&#39640;&#65281;</em></span>
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-mostefficentinverse"></a>14.1.3.&nbsp;Bag&#21644;list&#26159;&#21453;&#21521;&#38598;&#21512;&#31867;&#20013;&#25928;&#29575;&#26368;&#39640;&#30340;</h3></div></div><div></div></div><p>
            &#22909;&#20102;&#65292;&#22312;&#20320;&#25226;bag&#25172;&#21040;&#27700;&#27807;&#37324;&#38754;&#20877;&#36393;&#19978;&#19968;&#21482;&#33050;&#20043;&#21069;&#35201;&#20102;&#35299;&#65292;&#26377;&#19968;&#31181;&#24773;&#20917;&#19979;bag(&#21253;&#25324;list)&#35201;&#27604;set&#24615;&#33021;&#39640;&#24471;&#22810;&#12290;&#23545;&#20110;&#25351;&#26126;&#20102;<tt class="literal">inverse="true"</tt>&#30340;&#38598;&#21512;&#31867;&#65288;&#27604;&#22914;&#35828;&#65292;&#26631;&#20934;&#30340;&#21452;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;&#65289;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#19981;&#21021;&#22987;&#21270;(fetch)&#21253;&#20803;&#32032;&#30340;&#24773;&#20917;&#19979;&#23601;&#22686;&#21152;&#26032;&#20803;&#32032;&#65281;&#36825;&#26159;&#22240;&#20026;<tt class="literal">Collection.add()</tt>&#25110;&#32773;<tt class="literal">Collection.addAll()</tt>&#23545;bag&#25110;&#32773;<tt class="literal">List</tt>&#24635;&#26159;&#36820;&#22238;true&#30340;&#65288;&#19982;<tt class="literal">Set</tt>&#19981;&#21516;&#65289;&#12290;&#23545;&#20110;&#19979;&#38754;&#30340;&#20195;&#30721;&#26469;&#35828;&#65292;&#36895;&#24230;&#20250;&#24555;&#24471;&#22810;&#12290;
	        </p><pre class="programlisting">Parent p = (Parent) sess.load(Parent.class, id);
    Child c = new Child();
    c.setParent(p);
    p.getChildren().add(c);  //no need to fetch the collection!
    sess.flush();</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-oneshotdelete"></a>14.1.4.&nbsp;&#19968;&#27425;&#24615;&#21024;&#38500;(One shot delete)</h3></div></div><div></div></div><p>
	            &#26377;&#26102;&#20505;&#65292;&#19968;&#20010;&#19968;&#20010;&#30340;&#21024;&#38500;&#38598;&#21512;&#31867;&#20013;&#30340;&#20803;&#32032;&#26159;&#26497;&#24230;&#20302;&#25928;&#30340;&#12290;Hibernate&#27809;&#37027;&#20040;&#31528;&#65292;&#22914;&#26524;&#20320;&#24819;&#35201;&#25226;&#25972;&#20010;&#38598;&#21512;&#37117;&#21024;&#38500;&#65288;&#27604;&#22914;&#35828;&#35843;&#29992;<tt class="literal">list.clear()</tt>&#65289;&#65292;Hibernate&#21482;&#38656;&#35201;&#19968;&#20010;<tt class="literal">DELETE</tt>&#23601;&#25630;&#23450;&#20102;&#12290;
	        </p><p>
	            &#20551;&#35774;&#25105;&#20204;&#22312;&#19968;&#20010;&#38271;&#24230;&#20026;20&#30340;&#38598;&#21512;&#31867;&#20013;&#26032;&#22686;&#21152;&#20102;&#19968;&#20010;&#20803;&#32032;&#65292;&#28982;&#21518;&#21024;&#38500;&#20102;&#20004;&#20010;&#12290;Hibernate&#20250;&#23433;&#25490;&#19968;&#20010;<tt class="literal">INSERT</tt>&#35821;&#21477;&#21644;&#20004;&#26465;<tt class="literal">DELETE</tt>&#35821;&#21477;&#65288;&#38500;&#38750;&#38598;&#21512;&#31867;&#26159;&#19968;&#20010;bag)&#12290;&#36825;&#24403;&#28982;&#26159;&#21487;&#20197;&#24819;&#35265;&#30340;&#12290;
	        </p><p>
	            &#20294;&#26159;&#65292;&#22914;&#26524;&#20551;&#35774;&#25105;&#20204;&#21024;&#38500;&#20102;18&#20010;&#20803;&#32032;&#65292;&#21482;&#21097;&#19979;2&#20010;&#65292;&#28982;&#21518;&#26032;&#22686;3&#20010;&#12290;&#26377;&#20004;&#31181;&#22788;&#29702;&#26041;&#24335;&#65306;
	        </p><div class="itemizedlist"><ul type="disc"><li><p>&#25226;&#36825;18&#20010;&#20803;&#32032;&#19968;&#20010;&#19968;&#20010;&#30340;&#24178;&#25481;&#65292;&#20877;&#26032;&#22686;&#19977;&#20010;</p></li><li><p>&#25226;&#25972;&#20010;&#38598;&#21512;&#31867;&#37117;&#21652;&#22163;&#25481;&#65288;&#21482;&#29992;&#19968;&#21477;<tt class="literal">DELETE</tt>&#35821;&#21477;&#65289;&#65292;&#28982;&#21518;&#22686;&#21152;5&#20010;&#20803;&#32032;&#12290;
	            </p></li></ul></div><p>
	            Hibernate&#36824;&#27809;&#37027;&#20040;&#32874;&#26126;&#65292;&#30693;&#36947;&#31532;&#20108;&#31181;&#36873;&#25321;&#21487;&#33021;&#20250;&#27604;&#36739;&#24555;&#12290;&#65288;&#20063;&#35768;&#35753;Hibernate&#19981;&#35201;&#36825;&#20040;&#32874;&#26126;&#20063;&#26159;&#22909;&#20107;&#65292;&#21542;&#21017;&#21487;&#33021;&#20250;&#24341;&#21457;&#24847;&#22806;&#30340;&#25968;&#25454;&#24211;&#35302;&#21457;&#22120;&#20160;&#20040;&#30340;&#12290;&#65289;
	        </p><p>
	            &#24184;&#36816;&#30340;&#26159;&#65292;&#20320;&#21487;&#20197;&#24378;&#21046;&#20351;&#29992;&#31532;&#20108;&#31181;&#31574;&#30053;&#12290;&#20320;&#38656;&#35201;&#25226;&#21407;&#26469;&#30340;&#25972;&#20010;&#38598;&#21512;&#31867;&#37117;&#21462;&#28040;&#65288;&#21462;&#28040;&#20854;&#24341;&#29992;&#65289;&#65292;&#28982;&#21518;&#36820;&#22238;&#19968;&#20010;&#26032;&#23454;&#20363;&#21270;&#30340;&#38598;&#21512;&#31867;&#65292;&#21482;&#21253;&#21547;&#38656;&#35201;&#30340;&#20803;&#32032;&#12290;&#26377;&#20123;&#26102;&#20505;&#36825;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;
	        </p></div></div><p>
        &#25105;&#20204;&#24050;&#32463;&#20026;&#24744;&#23637;&#31034;&#20102;&#22914;&#20309;&#22312;&#23545;&#38598;&#21512;&#25345;&#20037;&#21270;&#26102;&#20351;&#29992;&#24310;&#36831;&#35013;&#36733;&#65288;lazy initialization&#65289;&#12290;&#23545;&#20110;&#36890;&#24120;&#30340;&#23545;&#35937;&#24341;&#29992;&#65292;&#20351;&#29992;CGLIB&#20195;&#29702;&#21487;&#20197;&#36798;&#21040;&#31867;&#20284;&#30340;&#25928;&#26524;&#12290;&#25105;&#20204;&#20063;&#25552;&#21040;&#36807;Hibernate&#22312;<tt class="literal">Session</tt>&#32423;&#21035;&#32531;&#23384;&#25345;&#20037;&#21270;&#23545;&#35937;&#12290;&#36824;&#26377;&#26356;&#22810;&#20808;&#36827;&#30340;&#32531;&#23384;&#31574;&#30053;&#65292;&#20320;&#21487;&#20197;&#20026;&#27599;&#19968;&#20010;&#31867;&#21333;&#29420;&#37197;&#32622;&#12290;
    </p><p>
        &#36825;&#26412;&#31456;&#37324;&#65292;&#25105;&#20204;&#26469;&#25945;&#20320;&#22914;&#20309;&#20351;&#29992;&#36825;&#20123;&#29305;&#24615;&#65292;&#22312;&#24517;&#35201;&#30340;&#26102;&#20505;&#24471;&#21040;&#39640;&#24471;&#22810;&#30340;&#24615;&#33021;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-proxies"></a>14.2.&nbsp;&#29992;&#20110;&#24310;&#36831;&#35013;&#36733;&#30340;&#20195;&#29702;</h2></div></div><div></div></div><p>
            Hibernate&#20351;&#29992;&#21160;&#24577;&#23383;&#33410;&#30721;&#22686;&#24378;&#25216;&#26415;&#26469;&#23454;&#29616;&#25345;&#20037;&#21270;&#23545;&#35937;&#30340;&#24310;&#36831;&#35013;&#36733;&#20195;&#29702;&#65288;&#20351;&#29992;&#20248;&#31168;&#30340;CGLIB&#24211;&#65289;&#12290;
        </p><p>
        	&#26144;&#23556;&#25991;&#20214;&#20026;&#27599;&#19968;&#20010;&#31867;&#22768;&#26126;&#19968;&#20010;&#31867;&#25110;&#32773;&#25509;&#21475;&#20316;&#20026;&#20195;&#29702;&#25509;&#21475;&#12290;&#24314;&#35758;&#20351;&#29992;&#36825;&#20010;&#31867;&#33258;&#36523;&#65306;
        </p><pre class="programlisting">&lt;class name="eg.Order" proxy="eg.Order"&gt;</pre><p>
            &#36816;&#34892;&#26102;&#30340;&#20195;&#29702;&#24212;&#35813;&#26159;<tt class="literal">Order</tt>&#30340;&#23376;&#31867;&#12290;&#27880;&#24847;&#34987;&#20195;&#29702;&#30340;&#31867;&#24517;&#39035;&#23454;&#29616;&#19968;&#20010;&#40664;&#35748;&#30340;&#26500;&#36896;&#22120;&#65292;&#24182;&#19988;&#33267;&#23569;&#22312;&#21253;&#20869;&#21487;&#35265;&#12290;
        </p><p>
            &#22312;&#25193;&#23637;&#36825;&#31181;&#26041;&#27861;&#26469;&#23545;&#24212;&#22810;&#24418;&#30340;&#31867;&#26102;&#65292;&#35201;&#27880;&#24847;&#19968;&#20123;&#32454;&#33410;,&#27604;&#22914;&#65306;
        </p><pre class="programlisting">&lt;class name="eg.Cat" proxy="eg.Cat"&gt;
    ......
    &lt;subclass name="eg.DomesticCat" proxy="eg.DomesticCat"&gt;
        .....
    &lt;/subclass&gt;
&lt;/class&gt;</pre><p>
            &#39318;&#20808;&#65292;<tt class="literal">Cat</tt>&#27704;&#36828;&#19981;&#33021;&#34987;&#24378;&#21046;&#36716;&#25442;&#20026;<tt class="literal">DomesticCat</tt>,&#21363;&#20351;&#23454;&#38469;&#19978;&#35813;&#23454;&#20363;&#23601;&#26159;&#19968;&#20010;<tt class="literal">DomesticCat</tt>&#23454;&#20363;&#12290;
        </p><pre class="programlisting">Cat cat = (Cat) session.load(Cat.class, id);  // instantiate a proxy (does not hit the db)
if ( cat.isDomesticCat() ) {                  // hit the db to initialize the proxy
    DomesticCat dc = (DomesticCat) cat;       // Error!
    ....
}</pre><p>
            &#20854;&#27425;&#65292;&#20195;&#29702;&#30340;<tt class="literal">==</tt>&#21487;&#33021;&#19981;&#20877;&#25104;&#31435;&#12290;
        </p><pre class="programlisting">
Cat cat = (Cat) session.load(Cat.class, id);            // instantiate a Cat proxy
DomesticCat dc = 
    (DomesticCat) session.load(DomesticCat.class, id);  // required new DomesticCat proxy!
System.out.println(cat==dc);                            // false</pre><p>
            &#34429;&#28982;&#22914;&#27492;&#65292;&#36825;&#31181;&#24773;&#20917;&#24182;&#19981;&#20687;&#30475;&#19978;&#21435;&#24471;&#37027;&#20040;&#31967;&#12290;&#34429;&#28982;&#25105;&#20204;&#29616;&#22312;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#24341;&#29992;&#26469;&#25351;&#21521;&#19981;&#21516;&#30340;&#20195;&#29702;&#23545;&#35937;&#65292;&#23454;&#38469;&#19978;&#24213;&#23618;&#30340;&#23454;&#20363;&#24212;&#35813;&#26159;&#21516;&#19968;&#20010;&#23545;&#35937;&#65306;
        </p><pre class="programlisting">cat.setWeight(11.0);  // hit the db to initialize the proxy
System.out.println( dc.getWeight() );  // 11.0</pre><p>
            &#31532;&#19977;&#65292;&#20320;&#19981;&#33021;&#23545;<tt class="literal">final</tt>&#30340;&#31867;&#25110;&#32773;&#20855;&#26377;<tt class="literal">final</tt>&#26041;&#27861;&#30340;&#31867;&#20351;&#29992;CGLIB&#20195;&#29702;&#12290;
        </p><p>
            &#26368;&#21518;,&#20551;&#22914;&#20320;&#30340;&#25345;&#20037;&#21270;&#23545;&#35937;&#22312;&#23454;&#20363;&#21270;&#30340;&#26102;&#20505;&#38656;&#35201;&#26576;&#20123;&#36164;&#28304;&#65288;&#27604;&#22914;&#65292;&#22312;&#23454;&#20363;&#21270;&#26041;&#27861;&#25110;&#32773;&#40664;&#35748;&#26500;&#36896;&#26041;&#27861;&#20013;&#65289;&#65292;&#36825;&#20123;&#36164;&#28304;&#20063;&#20250;&#34987;&#20195;&#29702;&#38656;&#35201;&#12290;&#20195;&#29702;&#31867;&#23454;&#38469;&#19978;&#26159;&#25345;&#20037;&#21270;&#31867;&#30340;&#23376;&#31867;&#12290;
        </p><p>
            &#36825;&#20123;&#38382;&#39064;&#37117;&#26469;&#28304;&#20110;Java&#30340;&#21333;&#26681;&#32487;&#25215;&#27169;&#22411;&#30340;&#22825;&#29983;&#38480;&#21046;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#36991;&#20813;&#36825;&#20123;&#38382;&#39064;&#65292;&#20320;&#30340;&#27599;&#20010;&#25345;&#20037;&#21270;&#31867;&#24517;&#39035;&#25277;&#35937;&#20986;&#19968;&#20010;&#25509;&#21475;&#65292;&#22768;&#26126;&#21830;&#19994;&#36923;&#36753;&#26041;&#27861;&#12290;&#20320;&#24212;&#35813;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#23450;&#36825;&#20123;&#25509;&#21475;&#65292;&#27604;&#22914;&#65306;
        </p><pre class="programlisting">&lt;class name="eg.Cat" proxy="eg.ICat"&gt;
    ......
    &lt;subclass name="eg.DomesticCat" proxy="eg.IDomesticCat"&gt;
        .....
    &lt;/subclass&gt;
&lt;/class&gt;</pre><p>
            &#36825;&#37324;<tt class="literal">Cat</tt>&#23454;&#29616;<tt class="literal">ICat</tt>&#25509;&#21475;&#65292;&#24182;&#19988;<tt class="literal">DomesticCat</tt>&#23454;&#29616;<tt class="literal">IDomesticCat</tt>&#25509;&#21475;&#12290;&#20110;&#26159; <tt class="literal">load()</tt>&#25110;&#32773;<tt class="literal">iterate()</tt>&#23601;&#20250;&#36820;&#22238;<tt class="literal">Cat</tt>&#21644;<tt class="literal">DomesticCat</tt>&#30340;&#23454;&#20363;&#30340;&#20195;&#29702;&#12290;(&#27880;&#24847;<tt class="literal">find()</tt>&#19981;&#20250;&#36820;&#22238;&#20195;&#29702;&#12290;)
        </p><pre class="programlisting">ICat cat = (ICat) session.load(Cat.class, catid);
Iterator iter = session.iterate("from cat in class eg.Cat where cat.name='fritz'");
ICat fritz = (ICat) iter.next();</pre><p>
            &#20851;&#31995;&#20063;&#26159;&#24310;&#36831;&#35013;&#36733;&#30340;&#12290;&#36825;&#24847;&#21619;&#30528;&#20320;&#24517;&#39035;&#25226;&#20219;&#20309;&#23646;&#24615;&#22768;&#26126;&#20026;<tt class="literal">ICat</tt>&#31867;&#22411;&#65292;&#32780;&#38750;<tt class="literal">Cat</tt>&#12290;
        </p><p>
            &#26576;&#20123;&#29305;&#23450;&#25805;&#20316;<span class="emphasis"><em>&#19981;</em></span>&#38656;&#35201;&#21021;&#22987;&#21270;&#20195;&#29702;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                        <tt class="literal">equals()</tt>, &#20551;&#22914;&#25345;&#20037;&#21270;&#31867;&#27809;&#26377;&#37325;&#36733;<tt class="literal">equals()</tt>
                    </p></li><li><p>
                        <tt class="literal">hashCode()</tt>, &#20551;&#22914;&#25345;&#20037;&#21270;&#31867;&#27809;&#26377;&#37325;&#36733;<tt class="literal">hashCode()</tt>
                    </p></li><li><p>
                        &#26631;&#35782;&#31526;&#30340;get&#26041;&#27861;
                    </p></li></ul></div><p>
            Hibernate&#20250;&#35782;&#21035;&#20986;&#37325;&#36733;&#20102;<tt class="literal">equals()</tt> &#25110;&#32773; <tt class="literal">hashCode()</tt>&#26041;&#27861;&#30340;&#25345;&#20037;&#21270;&#31867;&#12290;
        </p><p>
            &#22312;&#21021;&#22987;&#21270;&#20195;&#29702;&#30340;&#26102;&#20505;&#21457;&#29983;&#30340;&#24322;&#24120;&#20250;&#34987;&#21253;&#35013;&#25104;<tt class="literal">LazyInitializationException</tt>&#12290;
        </p><p>
        &#26377;&#26102;&#20505;&#25105;&#20204;&#38656;&#35201;&#20445;&#35777;&#22312;<tt class="literal">Session</tt>&#20851;&#38381;&#21069;&#26576;&#20010;&#20195;&#29702;&#25110;&#32773;&#38598;&#21512;&#24050;&#32463;&#34987;&#21021;&#22987;&#21270;&#20102;&#12290;&#24403;&#28982;&#65292;&#25105;&#20204;&#24635;&#26159;&#21487;&#20197;&#36890;&#36807;&#35843;&#29992;<tt class="literal">cat.getSex()</tt>&#25110;&#32773; <tt class="literal">cat.getKittens().size()</tt>&#20043;&#31867;&#30340;&#26041;&#27861;&#26469;&#30830;&#20445;&#36825;&#19968;&#28857;&#12290;&#20294;&#26159;&#36825;&#26679;&#31243;&#24207;&#21487;&#35835;&#24615;&#19981;&#20339;&#65292;&#20063;&#19981;&#31526;&#21512;&#36890;&#24120;&#30340;&#20195;&#30721;&#35268;&#33539;&#12290;&#38745;&#24577;&#26041;&#27861;<tt class="literal">Hibernate.initialize()</tt>&#21644;<tt class="literal">Hibernate.isInitialized()</tt>&#32473;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#19968;&#20010;&#27491;&#24120;&#30340;&#36884;&#24452;&#26469;&#21152;&#36733;&#38598;&#21512;&#25110;&#20195;&#29702;&#12290;<tt class="literal">Hibernate.initialize(cat)</tt> &#20250;&#24378;&#21046;&#21021;&#22987;&#21270;&#19968;&#20010;&#20195;&#29702;,<tt class="literal">cat</tt>,&#21482;&#35201;&#23427;&#30340;<tt class="literal">Session</tt>&#20173;&#28982;&#25171;&#24320;&#12290;<tt class="literal">Hibernate.initialize( cat.getKittens() )</tt>&#23545;kittens&#30340;&#38598;&#21512;&#20855;&#26377;&#21516;&#26679;&#30340;&#21151;&#33021;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-cache"></a>14.3.&nbsp;&#31532;&#20108;&#23618;&#32531;&#23384;(The Second Level Cache)s</h2></div></div><div></div></div><p>
            Hibernate<tt class="literal">Session</tt>&#26159;&#20107;&#21153;&#32423;&#21035;&#30340;&#25345;&#20037;&#21270;&#25968;&#25454;&#32531;&#23384;&#12290;&#20877;&#20026;&#27599;&#20010;&#31867;&#25110;&#32773;&#27599;&#20010;&#38598;&#21512;&#37197;&#32622;&#19968;&#20010;&#38598;&#32676;&#25110;&#32773;JVM&#32423;&#21035;(<tt class="literal">SessionFactory</tt>&#32423;&#21035;)&#30340;&#32531;&#23384;&#20063;&#26159;&#26377;&#21487;&#33021;&#30340;&#12290;&#20320;&#29978;&#33267;&#21487;&#20197;&#25554;&#20837;&#19968;&#20010;&#38598;&#32676;&#30340;&#32531;&#23384;&#12290;&#35201;&#23567;&#24515;&#65292;&#32531;&#23384;&#27704;&#36828;&#19981;&#20250;&#30693;&#36947;&#20854;&#20182;&#36827;&#31243;&#21487;&#33021;&#23545;&#25345;&#20037;&#21270;&#20179;&#24211;&#65288;&#25968;&#25454;&#24211;&#65289;&#36827;&#34892;&#30340;&#20462;&#25913;&#65288;&#21363;&#20351;&#20182;&#20204;&#21487;&#33021;&#35774;&#23450;&#20026;&#32463;&#24120;&#23545;&#32531;&#23384;&#30340;&#25968;&#25454;&#36827;&#34892;&#22833;&#25928;&#65289;&#12290;
        </p><p>

            &#40664;&#35748;&#24773;&#20917;&#19979;&#65292;Hibernate&#20351;&#29992;EHCache&#36827;&#34892;JVM&#32423;&#21035;&#30340;&#32531;&#23384;&#12290;&#20294;&#26159;&#65292;&#23545;JCS&#30340;&#25903;&#25345;&#29616;&#22312;&#24050;&#32463;&#34987;&#24223;&#24323;&#20102;&#65292;&#26410;&#26469;&#29256;&#26412;&#30340;Hibernate&#23558;&#20250;&#21435;&#25481;&#23427;&#12290;&#36890;&#36807;<tt class="literal">hibernate.cache.provider_class</tt>&#23646;&#24615;&#65292;&#20320;&#20063;&#21487;&#20197;&#25351;&#23450;&#20854;&#20182;&#32531;&#23384;&#65292;&#21482;&#35201;&#20854;&#23454;&#29616;&#20102;<tt class="literal">net.sf.hibernate.cache.CacheProvider</tt>&#25509;&#21475;&#12290; 
        </p><div class="table"><a name="d0e8649"></a><p class="title"><b>&#34920;&nbsp;14.1.&nbsp;Cache Providers</b></p><table summary="Cache Providers" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Cache</th><th align="left">Provider class</th><th align="left">Type</th><th align="left">Cluster Safe</th><th align="left">Query Cache Supported</th></tr></thead><tbody><tr><td align="left">Hashtable (not intended for production use)</td><td align="left"><tt class="literal">net.sf.hibernate.cache.HashtableCacheProvider</tt></td><td align="left">memory</td><td align="left">&nbsp;</td><td align="left">yes</td></tr><tr><td align="left">EHCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.EhCacheProvider</tt></td><td align="left">memory, disk</td><td align="left">&nbsp;</td><td align="left">yes</td></tr><tr><td align="left">OSCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.OSCacheProvider</tt></td><td align="left">memory, disk</td><td align="left">&nbsp;</td><td align="left">yes</td></tr><tr><td align="left">SwarmCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.SwarmCacheProvider</tt></td><td align="left">clustered (ip multicast)</td><td align="left">yes (clustered invalidation)</td><td align="left">&nbsp;</td></tr><tr><td align="left">JBoss TreeCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.TreeCacheProvider</tt></td><td align="left">clustered (ip multicast), transactional</td><td align="left">yes (replication)</td><td align="left">&nbsp;</td></tr></tbody></table></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-mapping"></a>14.3.1.&nbsp;&#23545;&#26144;&#23556;(Mapping)&#32531;&#20914;</h3></div></div><div></div></div><p>
                &#31867;&#25110;&#32773;&#38598;&#21512;&#26144;&#23556;&#30340;<tt class="literal">&lt;cache&gt;</tt>&#20803;&#32032;&#21487;&#33021;&#26377;&#19979;&#21015;&#24418;&#24335;&#65306;
            </p><div class="programlistingco"><pre class="programlisting">&lt;cache                                                      <span class="co">(1)</span>
                usage="transactional|read-write|nonstrict-read-write|read-only" /&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">usage</tt> &#25351;&#23450;&#20102;&#32531;&#23384;&#31574;&#30053;&#65306;
                            <tt class="literal">transactional</tt>,
                            <tt class="literal">read-write</tt>,
                            <tt class="literal">nonstrict-read-write</tt> &#25110;&#32773;
                            <tt class="literal">read-only</tt>
                        </p></td></tr></table></div></div><p>
                &#21478;&#22806; (&#25512;&#33616;&#39318;&#36873;?), &#20320;&#21487;&#20197;&#22312;<tt class="literal">hibernate.cfg.xml</tt>&#20013;&#25351;&#23450;<tt class="literal">&lt;class-cache&gt;</tt> &#21644; <tt class="literal">&lt;collection-cache&gt;</tt> &#20803;&#32032;&#12290;
            </p><p>
                <tt class="literal">usage</tt>&#23646;&#24615;&#25351;&#26126;&#20102;<span class="emphasis"><em>&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#65288;cache concurrency strategy&#65289;</em></span>&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-readonly"></a>14.3.2.&nbsp;&#31574;&#30053;&#65306;&#21482;&#35835;&#32531;&#23384;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#35835;&#21462;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#65292;&#20294;&#26159;&#24182;&#19981;&#25171;&#31639;&#20462;&#25913;&#23427;&#20204;&#65292;&#21487;&#20197;&#20351;&#29992;<tt class="literal">read-only</tt> &#32531;&#23384;&#12290;&#36825;&#26159;&#26368;&#31616;&#21333;&#65292;&#20063;&#26159;&#23454;&#29992;&#24615;&#26368;&#22909;&#30340;&#31574;&#30053;&#12290;&#29978;&#33267;&#22312;&#38598;&#32676;&#20013;&#65292;&#23427;&#20063;&#33021;&#23436;&#32654;&#22320;&#36816;&#20316;&#12290;
            </p><pre class="programlisting">&lt;class name="eg.Immutable" mutable="false"&gt;
    &lt;cache usage="read-only"/&gt;
    ....
&lt;/class&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-readwrite"></a>14.3.3.&nbsp;&#31574;&#30053;:&#35835;/&#20889;&#32531;&#23384;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#26356;&#26032;&#25968;&#25454;&#65292;&#21487;&#33021;<tt class="literal">read-write</tt>&#32531;&#23384;&#27604;&#36739;&#21512;&#36866;&#12290;&#22914;&#26524;&#38656;&#35201;&#21487;&#24207;&#21015;&#21270;&#20107;&#21153;&#38548;&#31163;&#32423;&#21035;&#65288;serializable transaction isolation level&#65289;&#65292;&#36825;&#31181;&#32531;&#23384;&#20915;&#19981;&#33021;&#20351;&#29992;&#12290;&#22914;&#26524;&#22312;JTA&#29615;&#22659;&#20013;&#20351;&#29992;&#36825;&#31181;&#32531;&#23384;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<tt class="literal">hibernate.transaction.manager_lookup_class</tt>&#23646;&#24615;&#30340;&#20540;&#65292;&#32473;&#20986;&#24471;&#21040;JTA <tt class="literal">TransactionManager</tt>&#30340;&#31574;&#30053;&#12290;&#22312;&#20854;&#23427;&#29615;&#22659;&#20013;&#65292;&#20320;&#24517;&#39035;&#30830;&#20445;&#22312;<tt class="literal">Session.close()</tt>&#25110;&#32773;<tt class="literal">Session.disconnect()</tt>&#35843;&#29992;&#21069;&#65292;&#20107;&#21153;&#24050;&#32463;&#32467;&#26463;&#20102;&#12290;
                &#22914;&#26524;&#20320;&#35201;&#22312;&#38598;&#32676;&#29615;&#22659;&#19979;&#20351;&#29992;&#36825;&#19968;&#31574;&#30053;&#65292;&#20320;&#24517;&#39035;&#30830;&#20445;&#24213;&#23618;&#30340;&#32531;&#23384;&#23454;&#29616;&#25903;&#25345;&#38145;&#23450;(locking)&#12290;&#20869;&#32622;&#30340;&#32531;&#23384;&#25552;&#20379;&#22120;<span class="emphasis"><em>&#24182;&#19981;</em></span>&#25903;&#25345;&#12290;
            </p><pre class="programlisting">&lt;class name="eg.Cat" .... &gt;
    &lt;cache usage="read-write"/&gt;
    ....
    &lt;set name="kittens" ... &gt;
        &lt;cache usage="read-write"/&gt;
        ....
    &lt;/set&gt;
&lt;/class&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-nonstrict"></a>14.3.4.&nbsp;&#31574;&#30053;:&#19981;&#20005;&#26684;&#30340;&#35835;/&#20889;&#32531;&#23384;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#31243;&#24207;&#20598;&#23572;&#38656;&#35201;&#26356;&#26032;&#25968;&#25454;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292;&#20986;&#29616;&#20004;&#20010;&#20107;&#21153;&#21516;&#26102;&#26356;&#26032;&#21516;&#19968;&#20010;&#26465;&#30446;&#30340;&#29616;&#35937;&#24456;&#19981;&#24120;&#35265;&#65289;&#65292;&#20063;&#19981;&#38656;&#35201;&#21313;&#20998;&#20005;&#26684;&#30340;&#20107;&#21153;&#38548;&#31163;&#65292;&#21487;&#33021;&#36866;&#29992;<tt class="literal">nonstrict-read-write</tt>&#32531;&#23384;&#12290;&#22914;&#26524;&#22312;JTA&#29615;&#22659;&#20013;&#20351;&#29992;&#36825;&#31181;&#32531;&#23384;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<tt class="literal">hibernate.transaction.manager_lookup_class</tt>&#23646;&#24615;&#30340;&#20540;&#65292;&#32473;&#20986;&#24471;&#21040;JTA <tt class="literal">TransactionManager</tt>&#30340;&#31574;&#30053;&#12290;&#22312;&#20854;&#23427;&#29615;&#22659;&#20013;&#65292;&#20320;&#24517;&#39035;&#30830;&#20445;&#22312;<tt class="literal">Session.close()</tt>&#25110;&#32773;<tt class="literal">Session.disconnect()</tt>&#35843;&#29992;&#21069;&#65292;&#20107;&#21153;&#24050;&#32463;&#32467;&#26463;&#20102;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-transactional"></a>14.3.5.&nbsp;&#31574;&#30053;:&#20107;&#21153;&#32531;&#23384;&#65288;transactional&#65289;</h3></div></div><div></div></div><p>
                <tt class="literal">transactional</tt>&#32531;&#23384;&#31574;&#30053;&#25552;&#20379;&#20102;&#23545;&#20840;&#20107;&#21153;&#32531;&#23384;&#25552;&#20379;,&#27604;&#22914;JBoss TreeCache&#30340;&#25903;&#25345;&#12290;&#36825;&#26679;&#30340;&#32531;&#23384;&#21482;&#33021;&#29992;&#20110;JTA&#29615;&#22659;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<tt class="literal">hibernate.transaction.manager_lookup_class</tt>&#12290;
            </p></div><p>
            &#27809;&#26377;&#19968;&#31181;&#32531;&#23384;&#25552;&#20379;&#22120;&#33021;&#22815;&#25903;&#25345;&#25152;&#26377;&#30340;&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#12290;&#19979;&#38754;&#30340;&#34920;&#21015;&#20986;&#27599;&#31181;&#25552;&#20379;&#22120;&#19982;&#21508;&#31181;&#24182;&#21457;&#31574;&#30053;&#30340;&#20860;&#23481;&#24615;&#12290;
        </p><div class="table"><a name="d0e8845"></a><p class="title"><b>&#34920;&nbsp;14.2.&nbsp;&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#25903;&#25345;(Cache Concurrency Strategy Support)</b></p><table summary="&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#25903;&#25345;(Cache Concurrency Strategy Support)" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Cache</th><th align="left">read-only</th><th align="left">nonstrict-read-write</th><th align="left">read-write</th><th align="left">transactional</th></tr></thead><tbody><tr><td align="left">Hashtable (not intended for production use)</td><td align="left">yes</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td></tr><tr><td align="left">EHCache</td><td align="left">yes</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td></tr><tr><td align="left">OSCache</td><td align="left">yes</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td></tr><tr><td align="left">SwarmCache</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td><td align="left">&nbsp;</td></tr><tr><td align="left">JBoss TreeCache</td><td align="left">yes</td><td align="left">&nbsp;</td><td align="left">&nbsp;</td><td align="left">yes</td></tr></tbody></table></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-sessioncache"></a>14.4.&nbsp;&#31649;&#29702;Session&#32531;&#23384;</h2></div></div><div></div></div><p>
            &#19981;&#31649;&#20309;&#26102;&#20320;&#20256;&#36882;&#19968;&#20010;&#23545;&#35937;&#32473;<tt class="literal">save()</tt>, <tt class="literal">update()</tt>&#25110;&#32773; <tt class="literal">saveOrUpdate()</tt> ,&#25110;&#32773;&#19981;&#31649;&#20309;&#26102;&#20320;&#20351;&#29992;<tt class="literal">load()</tt>, <tt class="literal">find()</tt>, <tt class="literal">iterate()</tt>&#25110;&#32773;<tt class="literal">filter()</tt>&#21462;&#24471;&#19968;&#20010;&#23545;&#35937;&#30340;&#26102;&#20505;,&#35813;&#23545;&#35937;&#34987;&#21152;&#20837;&#21040;<tt class="literal">Session</tt>&#30340;&#20869;&#37096;&#32531;&#23384;&#20013;&#12290;&#24403;&#21518;&#32487;&#30340;<tt class="literal">flush()</tt>&#34987;&#35843;&#29992;&#26102;&#65292;&#23545;&#35937;&#30340;&#29366;&#24577;&#20250;&#21644;&#25968;&#25454;&#24211;&#36827;&#34892;&#21516;&#27493;&#12290;&#22914;&#26524;&#20320;&#22312;&#22788;&#29702;&#22823;&#37327;&#23545;&#35937;&#24182;&#19988;&#38656;&#35201;&#26377;&#25928;&#30340;&#31649;&#29702;&#20869;&#23384;&#30340;&#26102;&#20505;&#65292;&#20320;&#21487;&#33021;&#19981;&#24076;&#26395;&#21457;&#29983;&#36825;&#31181;&#21516;&#27493;&#65292;<tt class="literal">evict()</tt>&#26041;&#27861;&#21487;&#20197;&#20174;&#32531;&#23384;&#20013;&#21435;&#25481;&#23545;&#35937;&#21644;&#23427;&#30340;&#38598;&#21512;&#12290;
        </p><pre class="programlisting">Iterator cats = sess.iterate("from eg.Cat as cat"); //a huge result set
while ( cats.hasNext() ) {
    Cat cat = (Cat) iter.next();
    doSomethingWithACat(cat);
    sess.evict(cat);
}</pre><p>
			Hibernate will evict associated entities automatically if the association is mapped
			with <tt class="literal">cascade="all"</tt> or <tt class="literal">cascade="all-delete-orphan"</tt>.
			&#22914;&#26524;&#20851;&#32852;&#36890;&#36807;<tt class="literal">cascade="all"</tt> &#25110;&#32773; <tt class="literal">cascade="all-delete-orphan"</tt>&#23454;&#29616;&#65292;Hibernate&#20250;&#33258;&#21160;&#21024;&#38500;&#20851;&#32852;&#30340;&#23454;&#20307;&#12290;
		</p><p>
            <tt class="literal">Session</tt>&#20063;&#25552;&#20379;&#20102;&#19968;&#20010;<tt class="literal">contains()</tt>&#26041;&#27861;&#26469;&#21028;&#26029;&#26159;&#21542;&#19968;&#20010;&#23454;&#20363;&#22788;&#20110;&#36825;&#20010;session&#30340;&#32531;&#23384;&#20013;&#12290;
        </p><p>
            &#35201;&#25226;&#25152;&#26377;&#30340;&#23545;&#35937;&#20174;session&#32531;&#23384;&#20013;&#23436;&#20840;&#28165;&#38500;&#65292;&#35831;&#35843;&#29992;<tt class="literal">Session.clear()</tt>&#12290;
        </p><p>
            &#23545;&#20110;&#31532;&#20108;&#23618;&#32531;&#23384;&#26469;&#35828;&#65292;&#22312;<tt class="literal">SessionFactory</tt>&#20013;&#23450;&#20041;&#20102;&#19968;&#20123;&#26041;&#27861;&#26469;&#20174;&#32531;&#23384;&#20013;&#28165;&#38500;&#19968;&#20010;&#23454;&#20363;&#12289;&#25972;&#20010;&#31867;&#12289;&#38598;&#21512;&#23454;&#20363;&#25110;&#32773;&#25972;&#20010;&#38598;&#21512;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-querycache"></a>14.5.&nbsp;&#26597;&#35810;&#32531;&#23384;(Query Cache)</h2></div></div><div></div></div><p>
            &#26597;&#35810;&#32467;&#26524;&#38598;&#20063;&#21487;&#20197;&#34987;&#32531;&#23384;&#12290;&#21482;&#26377;&#24403;&#32463;&#24120;&#20351;&#29992;&#21516;&#26679;&#30340;&#21442;&#25968;&#36827;&#34892;&#26597;&#35810;&#26102;&#65292;&#36825;&#25165;&#20250;&#26377;&#20123;&#29992;&#22788;&#12290;&#35201;&#20351;&#29992;&#26597;&#35810;&#32531;&#23384;&#65292;&#39318;&#20808;&#20320;&#35201;&#25171;&#24320;&#23427;&#65292;&#35774;&#32622;<tt class="literal">hibernate.cache.use_query_cache=true</tt>&#36825;&#20010;&#23646;&#24615;&#12290;&#36825;&#26679;&#20250;&#21019;&#24314;&#20004;&#20010;&#32531;&#23384;&#21306;&#22495;&#8212;&#8212;&#19968;&#20010;&#20445;&#23384;&#26597;&#35810;&#32467;&#26524;&#38598;(<tt class="literal">net.sf.hibernate.cache.QueryCache</tt>),&#21478;&#19968;&#20010;&#20445;&#23384;&#26368;&#36817;&#26597;&#35810;&#30340;&#34920;&#30340;&#26102;&#38388;&#25139;(<tt class="literal">net.sf.hibernate.cache.UpdateTimestampsCache</tt>)&#12290;&#35831;&#27880;&#24847;&#26597;&#35810;&#32531;&#23384;&#24182;&#19981;&#32531;&#23384;&#32467;&#26524;&#38598;&#20013;&#21253;&#21547;&#23454;&#20307;&#30340;&#29366;&#24577;&#65307;&#23427;&#21482;&#32531;&#23384;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#20540;&#21644;&#20540;&#31867;&#22411;&#30340;&#32467;&#26524;&#12290;&#25152;&#20197;&#26597;&#35810;&#32531;&#23384;&#36890;&#24120;&#20250;&#21644;&#31532;&#20108;&#23618;&#32531;&#23384;&#19968;&#36215;&#20351;&#29992;&#12290;
        </p><p>
            &#22823;&#22810;&#25968;&#26597;&#35810;&#24182;&#19981;&#20250;&#20174;&#32531;&#23384;&#20013;&#33719;&#24471;&#20160;&#20040;&#22909;&#22788;&#65292;&#25152;&#20197;&#40664;&#35748;&#26597;&#35810;&#26159;&#19981;&#36827;&#34892;&#32531;&#23384;&#30340;&#12290;&#35201;&#36827;&#34892;&#32531;&#23384;&#65292;&#35843;&#29992; <tt class="literal">Query.setCacheable(true)</tt>&#12290;&#36825;&#20010;&#35843;&#29992;&#20250;&#35753;&#26597;&#35810;&#22312;&#25191;&#34892;&#26102;&#21435;&#20174;&#32531;&#23384;&#20013;&#26597;&#25214;&#32467;&#26524;&#65292;&#25110;&#32773;&#25226;&#32467;&#26524;&#38598;&#25918;&#21040;&#32531;&#23384;&#21435;&#12290;
        </p><p>
            &#22914;&#26524;&#20320;&#35201;&#23545;&#26597;&#35810;&#32531;&#23384;&#30340;&#22833;&#25928;&#25919;&#31574;&#36827;&#34892;&#31934;&#30830;&#30340;&#25511;&#21046;&#65292;&#20320;&#24517;&#39035;&#35843;&#29992;<tt class="literal">Query.setCacheRegion()</tt>&#26469;&#20026;&#27599;&#20010;&#26597;&#35810;&#25351;&#23450;&#19968;&#20010;&#21629;&#21517;&#30340;&#32531;&#23384;&#21306;&#22495;&#12290;
        </p><pre class="programlisting">List blogs = sess.createQuery("from Blog blog where blog.blogger = :blogger")
    .setEntity("blogger", blogger)
    .setMaxResults(15)
    .setCacheable(true)
    .setCacheRegion("frontpages")
    .list();</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="querysql.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">&#19978;&#19968;&#32423;</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="toolsetguide.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#21407;&#29983;SQL&#26597;&#35810;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#31532;&nbsp;15&nbsp;&#31456;&nbsp;&#24037;&#20855;&#31665;&#25351;&#21335;</td></tr></table></div></body></html>